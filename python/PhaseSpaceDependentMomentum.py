from PhysicalParameters import PhysicalParameters
import UtilityFunctions as uf
import numpy as np

class PhaseSpaceDependentMomentum(object):
    """docstring for PhaseSpaceDependentMomentum"""
    def __init__(self, s12, s13, coeff = None, setup = None):
        self.p = PhysicalParameters().p

        self.spm = uf.get_spm(s12, s13) 

        

        # these are calculated by the script extract_momentum_dependence_RapidSim.py in /scripts
        setup_coefficients = {
            'lhcb_LL_p' : [-4.64, 27.24],
            'lhcb_LL_p_q0.025' : [-0.16, 4.50],
            'lhcb_LL_p_q0.050' : [-0.24, 5.31],
            'lhcb_LL_p_q0.075' : [-0.27, 5.96],
            'lhcb_LL_p_q0.100' : [-0.40, 6.62],
            'lhcb_LL_p_q0.125' : [-0.43, 7.19],
            'lhcb_LL_p_q0.150' : [-0.47, 7.71],
            'lhcb_LL_p_q0.175' : [-0.53, 8.23],
            'lhcb_LL_p_q0.200' : [-0.67, 8.85],
            'lhcb_LL_p_q0.225' : [-0.76, 9.41],
            'lhcb_LL_p_q0.250' : [-0.89, 10.01],
            'lhcb_LL_p_q0.275' : [-0.96, 10.55],
            'lhcb_LL_p_q0.300' : [-1.04, 11.16],
            'lhcb_LL_p_q0.325' : [-1.15, 11.78],
            'lhcb_LL_p_q0.350' : [-1.31, 12.46],
            'lhcb_LL_p_q0.375' : [-1.51, 13.23],
            'lhcb_LL_p_q0.400' : [-1.66, 13.95],
            'lhcb_LL_p_q0.425' : [-1.79, 14.68],
            'lhcb_LL_p_q0.450' : [-1.95, 15.46],
            'lhcb_LL_p_q0.475' : [-2.11, 16.34],
            'lhcb_LL_p_q0.500' : [-2.29, 17.21],
            'lhcb_LL_p_q0.525' : [-2.47, 18.13],
            'lhcb_LL_p_q0.550' : [-2.65, 19.11],
            'lhcb_LL_p_q0.575' : [-2.90, 20.23],
            'lhcb_LL_p_q0.600' : [-3.18, 21.47],
            'lhcb_LL_p_q0.625' : [-3.52, 22.81],
            'lhcb_LL_p_q0.650' : [-3.83, 24.24],
            'lhcb_LL_p_q0.675' : [-4.15, 25.78],
            'lhcb_LL_p_q0.700' : [-4.52, 27.50],
            'lhcb_LL_p_q0.725' : [-4.87, 29.34],
            'lhcb_LL_p_q0.750' : [-5.21, 31.40],
            'lhcb_LL_p_q0.775' : [-5.79, 33.90],
            'lhcb_LL_p_q0.800' : [-6.52, 36.90],
            'lhcb_LL_p_q0.825' : [-7.28, 40.33],
            'lhcb_LL_p_q0.850' : [-8.03, 44.34],
            'lhcb_LL_p_q0.875' : [-9.01, 49.28],
            'lhcb_LL_p_q0.900' : [-10.86, 56.47],
            'lhcb_LL_p_q0.925' : [-13.01, 66.02],
            'lhcb_LL_p_q0.950' : [-15.84, 80.70],
            'lhcb_LL_p_q0.975' : [-23.96, 111.89],


            'lhcb_DD_p' : [-7.39, 42.46],
            'lhcb_DD_p_q0.025' : [-0.49, 6.99],
            'lhcb_DD_p_q0.050' : [-0.66, 8.46],
            'lhcb_DD_p_q0.075' : [-0.87, 9.71],
            'lhcb_DD_p_q0.100' : [-1.06, 10.82],
            'lhcb_DD_p_q0.125' : [-1.22, 11.87],
            'lhcb_DD_p_q0.150' : [-1.49, 12.98],
            'lhcb_DD_p_q0.175' : [-1.71, 14.03],
            'lhcb_DD_p_q0.200' : [-1.83, 14.94],
            'lhcb_DD_p_q0.225' : [-2.05, 16.01],
            'lhcb_DD_p_q0.250' : [-2.20, 16.97],
            'lhcb_DD_p_q0.275' : [-2.37, 17.94],
            'lhcb_DD_p_q0.300' : [-2.53, 18.94],
            'lhcb_DD_p_q0.325' : [-2.81, 20.09],
            'lhcb_DD_p_q0.350' : [-3.02, 21.21],
            'lhcb_DD_p_q0.375' : [-3.28, 22.39],
            'lhcb_DD_p_q0.400' : [-3.47, 23.53],
            'lhcb_DD_p_q0.425' : [-3.72, 24.80],
            'lhcb_DD_p_q0.450' : [-3.96, 26.07],
            'lhcb_DD_p_q0.475' : [-4.25, 27.46],
            'lhcb_DD_p_q0.500' : [-4.45, 28.80],
            'lhcb_DD_p_q0.525' : [-4.67, 30.26],
            'lhcb_DD_p_q0.550' : [-4.93, 31.79],
            'lhcb_DD_p_q0.575' : [-5.26, 33.50],
            'lhcb_DD_p_q0.600' : [-5.70, 35.40],
            'lhcb_DD_p_q0.625' : [-6.07, 37.37],
            'lhcb_DD_p_q0.650' : [-6.43, 39.50],
            'lhcb_DD_p_q0.675' : [-6.73, 41.70],
            'lhcb_DD_p_q0.700' : [-7.35, 44.39],
            'lhcb_DD_p_q0.725' : [-7.83, 47.14],
            'lhcb_DD_p_q0.750' : [-8.42, 50.27],
            'lhcb_DD_p_q0.775' : [-9.37, 54.15],
            'lhcb_DD_p_q0.800' : [-10.33, 58.51],
            'lhcb_DD_p_q0.825' : [-11.31, 63.47],
            'lhcb_DD_p_q0.850' : [-12.31, 69.43],
            'lhcb_DD_p_q0.875' : [-13.58, 76.65],
            'lhcb_DD_p_q0.900' : [-15.83, 86.38],
            'lhcb_DD_p_q0.925' : [-18.85, 99.76],
            'lhcb_DD_p_q0.950' : [-23.54, 120.47],
            'lhcb_DD_p_q0.975' : [-33.57, 161.94],

             'lhcb_LL_pz' : [-4.61, 27.11],
            'lhcb_LL_pz_q0.025' : [-0.16, 4.43],
            'lhcb_LL_pz_q0.050' : [-0.23, 5.22],
            'lhcb_LL_pz_q0.075' : [-0.27, 5.88],
            'lhcb_LL_pz_q0.100' : [-0.38, 6.52],
            'lhcb_LL_pz_q0.125' : [-0.42, 7.09],
            'lhcb_LL_pz_q0.150' : [-0.46, 7.61],
            'lhcb_LL_pz_q0.175' : [-0.50, 8.12],
            'lhcb_LL_pz_q0.200' : [-0.64, 8.74],
            'lhcb_LL_pz_q0.225' : [-0.74, 9.29],
            'lhcb_LL_pz_q0.250' : [-0.87, 9.89],
            'lhcb_LL_pz_q0.275' : [-0.96, 10.45],
            'lhcb_LL_pz_q0.300' : [-1.02, 11.03],
            'lhcb_LL_pz_q0.325' : [-1.14, 11.65],
            'lhcb_LL_pz_q0.350' : [-1.30, 12.35],
            'lhcb_LL_pz_q0.375' : [-1.50, 13.10],
            'lhcb_LL_pz_q0.400' : [-1.63, 13.82],
            'lhcb_LL_pz_q0.425' : [-1.76, 14.54],
            'lhcb_LL_pz_q0.450' : [-1.91, 15.33],
            'lhcb_LL_pz_q0.475' : [-2.09, 16.22],
            'lhcb_LL_pz_q0.500' : [-2.24, 17.06],
            'lhcb_LL_pz_q0.525' : [-2.45, 18.00],
            'lhcb_LL_pz_q0.550' : [-2.63, 18.98],
            'lhcb_LL_pz_q0.575' : [-2.86, 20.08],
            'lhcb_LL_pz_q0.600' : [-3.16, 21.33],
            'lhcb_LL_pz_q0.625' : [-3.48, 22.65],
            'lhcb_LL_pz_q0.650' : [-3.77, 24.06],
            'lhcb_LL_pz_q0.675' : [-4.11, 25.62],
            'lhcb_LL_pz_q0.700' : [-4.48, 27.35],
            'lhcb_LL_pz_q0.725' : [-4.84, 29.17],
            'lhcb_LL_pz_q0.750' : [-5.18, 31.26],
            'lhcb_LL_pz_q0.775' : [-5.72, 33.73],
            'lhcb_LL_pz_q0.800' : [-6.47, 36.74],
            'lhcb_LL_pz_q0.825' : [-7.24, 40.19],
            'lhcb_LL_pz_q0.850' : [-7.99, 44.20],
            'lhcb_LL_pz_q0.875' : [-8.99, 49.14],
            'lhcb_LL_pz_q0.900' : [-10.81, 56.31],
            'lhcb_LL_pz_q0.925' : [-12.99, 65.92],
            'lhcb_LL_pz_q0.950' : [-15.73, 80.48],
            'lhcb_LL_pz_q0.975' : [-23.89, 111.73],



            'lhcb_DD_pz' : [-7.35, 42.32],
            'lhcb_DD_pz_q0.025' : [-0.48, 6.89],
            'lhcb_DD_pz_q0.050' : [-0.63, 8.35],
            'lhcb_DD_pz_q0.075' : [-0.87, 9.61],
            'lhcb_DD_pz_q0.100' : [-1.04, 10.69],
            'lhcb_DD_pz_q0.125' : [-1.21, 11.75],
            'lhcb_DD_pz_q0.150' : [-1.48, 12.86],
            'lhcb_DD_pz_q0.175' : [-1.65, 13.84],
            'lhcb_DD_pz_q0.200' : [-1.80, 14.80],
            'lhcb_DD_pz_q0.225' : [-2.03, 15.86],
            'lhcb_DD_pz_q0.250' : [-2.16, 16.83],
            'lhcb_DD_pz_q0.275' : [-2.34, 17.79],
            'lhcb_DD_pz_q0.300' : [-2.51, 18.81],
            'lhcb_DD_pz_q0.325' : [-2.75, 19.91],
            'lhcb_DD_pz_q0.350' : [-2.98, 21.06],
            'lhcb_DD_pz_q0.375' : [-3.25, 22.24],
            'lhcb_DD_pz_q0.400' : [-3.44, 23.39],
            'lhcb_DD_pz_q0.425' : [-3.67, 24.64],
            'lhcb_DD_pz_q0.450' : [-3.93, 25.93],
            'lhcb_DD_pz_q0.475' : [-4.21, 27.31],
            'lhcb_DD_pz_q0.500' : [-4.42, 28.66],
            'lhcb_DD_pz_q0.525' : [-4.63, 30.12],
            'lhcb_DD_pz_q0.550' : [-4.90, 31.64],
            'lhcb_DD_pz_q0.575' : [-5.21, 33.33],
            'lhcb_DD_pz_q0.600' : [-5.69, 35.28],
            'lhcb_DD_pz_q0.625' : [-6.04, 37.24],
            'lhcb_DD_pz_q0.650' : [-6.38, 39.34],
            'lhcb_DD_pz_q0.675' : [-6.70, 41.57],
            'lhcb_DD_pz_q0.700' : [-7.31, 44.23],
            'lhcb_DD_pz_q0.725' : [-7.82, 47.04],
            'lhcb_DD_pz_q0.750' : [-8.37, 50.11],
            'lhcb_DD_pz_q0.775' : [-9.32, 54.01],
            'lhcb_DD_pz_q0.800' : [-10.30, 58.38],
            'lhcb_DD_pz_q0.825' : [-11.22, 63.29],
            'lhcb_DD_pz_q0.850' : [-12.23, 69.24],
            'lhcb_DD_pz_q0.875' : [-13.52, 76.52],
            'lhcb_DD_pz_q0.900' : [-15.76, 86.21],
            'lhcb_DD_pz_q0.925' : [-18.76, 99.59],
            'lhcb_DD_pz_q0.950' : [-23.51, 120.38],
            'lhcb_DD_pz_q0.975' : [-33.51, 161.81],

            'belle_VDX_p' : [-0.41, 1.42],
            'belle_VDX_p_q0.025' : [0.03, 0.20],
            'belle_VDX_p_q0.050' : [0.02, 0.28],
            'belle_VDX_p_q0.075' : [-0.00, 0.36],
            'belle_VDX_p_q0.100' : [-0.02, 0.43],
            'belle_VDX_p_q0.125' : [-0.05, 0.49],
            'belle_VDX_p_q0.150' : [-0.07, 0.55],
            'belle_VDX_p_q0.175' : [-0.09, 0.61],
            'belle_VDX_p_q0.200' : [-0.11, 0.66],
            'belle_VDX_p_q0.225' : [-0.13, 0.72],
            'belle_VDX_p_q0.250' : [-0.16, 0.78],
            'belle_VDX_p_q0.275' : [-0.18, 0.84],
            'belle_VDX_p_q0.300' : [-0.20, 0.89],
            'belle_VDX_p_q0.325' : [-0.22, 0.94],
            'belle_VDX_p_q0.350' : [-0.24, 1.00],
            'belle_VDX_p_q0.375' : [-0.26, 1.06],
            'belle_VDX_p_q0.400' : [-0.28, 1.11],
            'belle_VDX_p_q0.425' : [-0.31, 1.17],
            'belle_VDX_p_q0.450' : [-0.33, 1.23],
            'belle_VDX_p_q0.475' : [-0.35, 1.29],
            'belle_VDX_p_q0.500' : [-0.37, 1.35],
            'belle_VDX_p_q0.525' : [-0.39, 1.40],
            'belle_VDX_p_q0.550' : [-0.42, 1.46],
            'belle_VDX_p_q0.575' : [-0.44, 1.52],
            'belle_VDX_p_q0.600' : [-0.46, 1.58],
            'belle_VDX_p_q0.625' : [-0.49, 1.64],
            'belle_VDX_p_q0.650' : [-0.51, 1.70],
            'belle_VDX_p_q0.675' : [-0.54, 1.77],
            'belle_VDX_p_q0.700' : [-0.57, 1.83],
            'belle_VDX_p_q0.725' : [-0.59, 1.90],
            'belle_VDX_p_q0.750' : [-0.62, 1.97],
            'belle_VDX_p_q0.775' : [-0.65, 2.04],
            'belle_VDX_p_q0.800' : [-0.69, 2.12],
            'belle_VDX_p_q0.825' : [-0.72, 2.20],
            'belle_VDX_p_q0.850' : [-0.76, 2.30],
            'belle_VDX_p_q0.875' : [-0.79, 2.40],
            'belle_VDX_p_q0.900' : [-0.84, 2.52],
            'belle_VDX_p_q0.925' : [-0.90, 2.66],
            'belle_VDX_p_q0.950' : [-0.96, 2.82],
            'belle_VDX_p_q0.975' : [-1.06, 3.07],

            'belle_VDX_pt' : [-0.28, 1.02],
            'belle_VDX_pt_q0.025' : [-0.00, 0.12],
            'belle_VDX_pt_q0.050' : [-0.00, 0.16],
            'belle_VDX_pt_q0.075' : [-0.01, 0.21],
            'belle_VDX_pt_q0.100' : [-0.02, 0.25],
            'belle_VDX_pt_q0.125' : [-0.02, 0.29],
            'belle_VDX_pt_q0.150' : [-0.03, 0.33],
            'belle_VDX_pt_q0.175' : [-0.05, 0.37],
            'belle_VDX_pt_q0.200' : [-0.06, 0.41],
            'belle_VDX_pt_q0.225' : [-0.07, 0.45],
            'belle_VDX_pt_q0.250' : [-0.08, 0.49],
            'belle_VDX_pt_q0.275' : [-0.10, 0.53],
            'belle_VDX_pt_q0.300' : [-0.11, 0.57],
            'belle_VDX_pt_q0.325' : [-0.12, 0.61],
            'belle_VDX_pt_q0.350' : [-0.14, 0.65],
            'belle_VDX_pt_q0.375' : [-0.15, 0.69],
            'belle_VDX_pt_q0.400' : [-0.17, 0.73],
            'belle_VDX_pt_q0.425' : [-0.18, 0.77],
            'belle_VDX_pt_q0.450' : [-0.19, 0.82],
            'belle_VDX_pt_q0.475' : [-0.21, 0.86],
            'belle_VDX_pt_q0.500' : [-0.22, 0.90],
            'belle_VDX_pt_q0.525' : [-0.24, 0.95],
            'belle_VDX_pt_q0.550' : [-0.26, 1.00],
            'belle_VDX_pt_q0.575' : [-0.28, 1.05],
            'belle_VDX_pt_q0.600' : [-0.30, 1.10],
            'belle_VDX_pt_q0.625' : [-0.32, 1.16],
            'belle_VDX_pt_q0.650' : [-0.35, 1.22],
            'belle_VDX_pt_q0.675' : [-0.37, 1.28],
            'belle_VDX_pt_q0.700' : [-0.39, 1.34],
            'belle_VDX_pt_q0.725' : [-0.42, 1.40],
            'belle_VDX_pt_q0.750' : [-0.44, 1.47],
            'belle_VDX_pt_q0.775' : [-0.47, 1.54],
            'belle_VDX_pt_q0.800' : [-0.50, 1.61],
            'belle_VDX_pt_q0.825' : [-0.53, 1.69],
            'belle_VDX_pt_q0.850' : [-0.57, 1.77],
            'belle_VDX_pt_q0.875' : [-0.61, 1.87],
            'belle_VDX_pt_q0.900' : [-0.65, 1.97],
            'belle_VDX_pt_q0.925' : [-0.70, 2.08],
            'belle_VDX_pt_q0.950' : [-0.75, 2.21],
            'belle_VDX_pt_q0.975' : [-0.82, 2.38]
        }


        # make the interpolation
        if setup in setup_coefficients:
            coeff = setup_coefficients[setup]
            self.p =  self.spm * coeff[0] + coeff[1]
            self.p[self.p <= 0] = 0.001
        else:
            raise ValueError('Unknown setup "{}" in PhaseSpaceDependentMomentum!'.format(setup))
        return

        
